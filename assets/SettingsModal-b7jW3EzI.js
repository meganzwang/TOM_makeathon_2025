import{r as a,j as e}from"./index-CwCHFERS.js";function q(o){return o.toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}function O(o){const{onClose:l,pageTitle:d="Settings",rows:n=3,cols:i=3,items:x=[],allPages:m=[],onUpdateLayout:c,onAddItem:w,onUpdateItem:I,onDeleteItem:F,onCreatePage:j,password:p="123",onChangePassword:U}=o,[b,A]=a.useState(!1),[N,R]=a.useState(""),[v,z]=a.useState(null),[f,y]=a.useState(n),[C,k]=a.useState(i),[P,h]=a.useState(x),[$,S]=a.useState(p);a.useEffect(()=>y(n),[n]),a.useEffect(()=>k(i),[i]),a.useEffect(()=>h(x),[x]),a.useEffect(()=>S(p),[p]),a.useEffect(()=>{if(!b)return;const s=window.setTimeout(l,3e4);return z(s),()=>window.clearTimeout(s)},[b,l]),a.useEffect(()=>{const s=t=>{t.key==="Escape"&&l()};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[l]);const T=a.useMemo(()=>m,[m]),M=(s,t)=>{y(s),k(t),c?.(s,t)},B=()=>{if(w){w();return}const s={id:Math.random().toString(36).slice(2),label:"New Button",type:"audio",audioUrl:"https://actions.google.com/sounds/v1/alarms/beep_short.ogg",rowSpan:1,colSpan:1};h(t=>[...t,s])},u=s=>{I?.(s),h(t=>t.map(r=>r.id===s.id?s:r))},D=s=>{F?.(s),h(t=>t.filter(r=>r.id!==s))},K=(s,t,r)=>{const g=j?.(s,t,r);if(!j){const L=q(s||"page-"+Math.random().toString(36).slice(2));return alert(`Page created (demo): ${s||"Untitled"} (id: ${L})`),L}return typeof g=="string"&&g&&alert(`Page created: ${s||"Untitled"} (id: ${g})`),g},_=()=>{N===(p??"123")?A(!0):alert("Incorrect password")},E=()=>{v&&window.clearTimeout(v),l()};return e.jsx("div",{className:"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm flex items-center justify-center px-4",onClick:E,children:e.jsxs("div",{role:"dialog","aria-modal":"true","aria-labelledby":"settings-title",className:"w-full max-w-3xl max-h-[80vh] overflow-y-auto rounded-xl shadow-xl ring-1 ring-black/10",style:{backgroundColor:"#C3B1E1"},onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-black/10",children:[e.jsx("button",{className:"text-sm px-3 py-2 rounded-md bg-white/70 hover:bg-white",onClick:E,children:"✕ Close"}),e.jsx("div",{id:"settings-title",className:"font-semibold text-neutral-900",children:d}),e.jsx("div",{})]}),b?e.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 gap-6 text-neutral-900",children:[e.jsxs("section",{className:"bg-white/60 rounded p-3",children:[e.jsx("h2",{className:"font-semibold mb-2",children:"Layout"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm",children:"Rows"}),e.jsx("input",{type:"number",min:1,max:12,className:"border rounded px-2 py-1 w-20 bg-white",value:f,onChange:s=>M(Math.max(1,Math.min(12,Number(s.target.value))),C)}),e.jsx("label",{className:"text-sm",children:"Cols"}),e.jsx("input",{type:"number",min:1,max:12,className:"border rounded px-2 py-1 w-20 bg-white",value:C,onChange:s=>M(f,Math.max(1,Math.min(12,Number(s.target.value))))})]}),e.jsx("p",{className:"text-xs mt-2 text-neutral-700",children:"Tip: Keep rows/cols modest to avoid tiny buttons."})]}),e.jsxs("section",{className:"bg-white/60 rounded p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"font-semibold mb-2",children:"Buttons"}),e.jsx("button",{className:"px-2 py-1 rounded bg-[#9146FF] text-white",onClick:B,children:"+ Add"})]}),e.jsxs("div",{className:"space-y-3 max-h-64 overflow-auto pr-2",children:[P.length===0&&e.jsx("div",{className:"text-sm text-neutral-700",children:"No buttons yet."}),P.map(s=>e.jsxs("div",{className:"border rounded p-2 bg-white/80",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs",children:"Label"}),e.jsx("input",{className:"border rounded w-full px-2 py-1 bg-white",value:s.label,onChange:t=>u({...s,label:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs",children:"Type"}),e.jsxs("select",{className:"border rounded w-full px-2 py-1 bg-white",value:s.type,onChange:t=>u({...s,type:t.target.value}),children:[e.jsx("option",{value:"audio",children:"Audio"}),e.jsx("option",{value:"link",children:"Link"})]})]}),s.type==="audio"?e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"text-xs",children:"Audio URL"}),e.jsx("input",{className:"border rounded w-full px-2 py-1 bg-white",value:s.audioUrl||"",onChange:t=>u({...s,audioUrl:t.target.value})})]}):e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"text-xs",children:"Link to Page"}),T.length>0?e.jsxs("select",{className:"border rounded w-full px-2 py-1 bg-white",value:s.linkTo||"",onChange:t=>u({...s,linkTo:t.target.value}),children:[e.jsx("option",{value:"",children:"Select page"}),T.map(t=>e.jsxs("option",{value:t.id,children:[t.title," (",t.id,")"]},t.id))]}):e.jsx("input",{className:"border rounded w-full px-2 py-1 bg-white",placeholder:"Target page id",value:s.linkTo||"",onChange:t=>u({...s,linkTo:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs",children:"Row span"}),e.jsx("input",{type:"number",min:1,className:"border rounded w-full px-2 py-1 bg-white",value:s.rowSpan||1,onChange:t=>u({...s,rowSpan:Math.max(1,Number(t.target.value))})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs",children:"Col span"}),e.jsx("input",{type:"number",min:1,className:"border rounded w-full px-2 py-1 bg-white",value:s.colSpan||1,onChange:t=>u({...s,colSpan:Math.max(1,Number(t.target.value))})})]})]}),e.jsx("div",{className:"mt-2 flex justify-end",children:e.jsx("button",{className:"text-sm px-2 py-1 rounded bg-red-500 text-white",onClick:()=>D(s.id),children:"Delete"})})]},s.id))]})]}),e.jsxs("section",{className:"md:col-span-2 bg-white/60 rounded p-3",children:[e.jsx("h2",{className:"font-semibold mb-2",children:"Create Page"}),e.jsx(G,{onCreate:(s,t,r)=>K(s,t,r)}),e.jsx("p",{className:"text-xs mt-2 text-neutral-700",children:"After creating a page, set a button Type=Link and choose the new page in “Link to Page”."})]}),e.jsxs("section",{className:"md:col-span-2 bg-white/60 rounded p-3",children:[e.jsx("h2",{className:"font-semibold mb-2",children:"Password"}),e.jsx(H,{current:$,onChange:s=>{S(s),U?.(s)}})]})]}):e.jsxs("div",{className:"p-4 flex items-center gap-2",children:[e.jsx("input",{type:"password",className:"border rounded px-3 py-2 w-48 bg-white",placeholder:"Enter password",value:N,onChange:s=>R(s.target.value)}),e.jsx("button",{className:"px-3 py-2 rounded bg-[#9146FF] text-white",onClick:_,children:"Unlock"})]})]})})}function G({onCreate:o}){const[l,d]=a.useState(""),[n,i]=a.useState(3),[x,m]=a.useState(3);return e.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs",children:"Title"}),e.jsx("input",{className:"border rounded px-2 py-1 bg-white",value:l,onChange:c=>d(c.target.value),placeholder:"New page title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs",children:"Rows"}),e.jsx("input",{type:"number",min:1,max:12,className:"border rounded px-2 py-1 w-20 bg-white",value:n,onChange:c=>i(Math.max(1,Math.min(12,Number(c.target.value))))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs",children:"Cols"}),e.jsx("input",{type:"number",min:1,max:12,className:"border rounded px-2 py-1 w-20 bg-white",value:x,onChange:c=>m(Math.max(1,Math.min(12,Number(c.target.value))))})]}),e.jsx("button",{className:"px-3 py-2 rounded bg-[#9146FF] text-white",onClick:()=>{o(l,n,x),d("")},children:"Create"})]})}function H({current:o,onChange:l}){const[d,n]=a.useState(o);return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{className:"border rounded px-2 py-1 bg-white",value:d,onChange:i=>n(i.target.value),type:"password",placeholder:"New password"}),e.jsx("button",{className:"px-3 py-2 rounded bg-[#9146FF] text-white",onClick:()=>l(d),children:"Save Password"})]})}export{O as default};
